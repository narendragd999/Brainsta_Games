<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solitaire Klondike</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: linear-gradient(to bottom, #e5c1d1 0%, #d3e6f5 100%);
    }
    #game-container {
      display: grid;
      grid-template-rows: auto 1fr auto;
      grid-template-columns: 1fr;
      align-items: center;
      justify-items: center;
      width: 100vw;
      max-width: 600px;
      padding: 16px;
      box-sizing: border-box;
    }
    .solitaire-board {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-gap: 12px;
      justify-items: center;
      align-items: start;
      margin-top: 24px;
    }
    .pile, .foundation, .stock, .waste {
      min-width: 52px;
      min-height: 72px;
      background: rgba(255,255,255,0.85);
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(160,80,210,0.14);
      cursor: pointer;
      transition: box-shadow 0.2s, background 0.2s;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .pile.selected, .foundation.selected, .stock.selected, .waste.selected {
      box-shadow: 0 0 0 4px #aa90ac, 0 2px 6px rgba(160,80,210,0.14);
      background: #e5c1d1;
    }
    .card {
      width: 48px;
      height: 68px;
      margin: 2px 0;
      border-radius: 6px;
      background: linear-gradient(135deg, #fff, #f5e5f5 60%);
      box-shadow: 0 1px 4px rgba(60,80,210,0.10);
      font-size: 1.1em;
      color: #444;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      position: absolute;
      transition: box-shadow 0.2s;
      z-index: 1;
    }
    .card.faceup { font-weight: bold; }
    .card.facedown {
      background: repeating-linear-gradient(135deg, #d3e6f5 2px, #e5c1d1 4px);
      color: transparent;
      box-shadow: 0 1px 10px #bab6ca;
    }
    .card.selected {
      box-shadow: 0 0 0 2px #4a518c;
      outline: 2px solid #d3e6f5;
    }
    /* Responsive adjustments */
    @media (max-width: 500px) {
      #game-container { max-width: 98vw; }
      .solitaire-board { grid-template-columns: repeat(7, 1fr); grid-gap: 8px; }
      .card, .pile, .foundation, .stock, .waste { min-width: 36px; min-height: 50px; width: 36px; height: 50px; }
    }
    /* Instructions popup styles */
    #instructions-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 48px rgba(90,170,200,0.17);
      padding: 0 20px 16px 20px;
      z-index: 1000;
      display: none;
      text-align: center;
      min-width: 225px;
    }
    #instructions-popup h2 {
      margin-top: 8px;
      color: #e5c1d1;
      font-weight: bold;
    }
    #instructions-popup p {
      color: #444;
      font-size: 1em;
    }
    #instructions-close {
      cursor: pointer;
      font-size: 1.8em;
      color: #d3e6f5;
      background: none;
      border: none;
      position: absolute;
      top: 10px;
      right: 15px;
    }
    /* Icon for instructions */
    .instructions-icon {
      position: absolute;
      top: 10px;
      right: 18px;
      cursor: pointer;
      z-index: 900;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #e5c1d1 60%, #d3e6f5 100%);
      border-radius: 50%;
      box-shadow: 0 2px 6px rgba(200,160,210,0.14);
    }
    .instructions-icon svg {
      width: 24px;
      height: 24px;
      fill: #4a518c;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div class="instructions-icon" onclick="showInstructions()">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" /><text x="12" y="16" text-anchor="middle" font-size="12" fill="#4a518c" font-family="Arial">?</text></svg>
    </div>
    <div class="solitaire-board" id="board">
      <!-- Dynamically filled by JS -->
    </div>
  </div>

  <!-- Instructions popup -->
  <div id="instructions-popup">
    <button id="instructions-close" onclick="hideInstructions()">×</button>
    <h2>How to Play</h2>
    <p>
      Move cards between Tableau columns building downward alternating colors. <br>
      Place cards into Foundation piles sorted by suit, Ace to King.<br>
      Click Stock to draw cards. Double-tap to move cards to Foundations.<br>
      Win by sorting all cards into Foundations!
    </p>
  </div>

  <!-- Solitaire JS -->
  <script>
    // Basic Solitaire data model
    class Card {
      constructor(suit, rank, faceup=false) {
        this.suit = suit; // "♠♥♦♣"
        this.rank = rank; // 1-13
        this.faceup = faceup;
      }
      color() { return (["♥","♦"].includes(this.suit)) ? "red" : "black"; }
      toString() {
        let rankStr = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"][this.rank-1];
        return `${rankStr}${this.suit}`;
      }
    }
    const suits = ["♠","♥","♦","♣"];
    const board = {
      piles: [[],[],[],[],[],[],[]], // tableau columns
      foundations: [[],[],[],[]], // ace piles
      stock: [], // draw pile
      waste: [], // discard
      selected: null
    };
    function newDeck() {
      let deck = [];
      for (let s of suits) for (let r = 1; r<=13; r++) deck.push(new Card(s, r));
      for (let i=deck.length-1; i>0; i--) { // Shuffle
        let j = Math.floor(Math.random()*(i+1)); [deck[i],deck[j]]=[deck[j],deck[i]];
      }
      return deck;
    }
    // Deal cards
    function deal() {
      let deck = newDeck();
      // Tableau
      for (let i=0; i<7; i++) {
        for (let j=0; j<=i; j++) {
          let faceup = (j === i);
          board.piles[i].push(new Card(deck.suit, deck.rank, faceup));
          deck.shift();
        }
      }
      // Stock
      board.stock = deck;
      render();
    }
    function render() {
      const boardDiv = document.getElementById('board');
      boardDiv.innerHTML = '';
      // Foundations and Stock/Waste
      let row1 = document.createElement('div');
      row1.style.display = 'grid';
      row1.style.gridTemplateColumns = 'repeat(7, 1fr)';
      row1.style.marginBottom = '15px';
      // Stock
      let stockDiv = document.createElement('div');
      stockDiv.className = 'stock';
      stockDiv.onclick = drawFromStock;
      if(board.stock.length) {
        let cardDiv = createCardDiv(board.stock[board.stock.length-1], false);
        stockDiv.appendChild(cardDiv);
      }
      row1.appendChild(stockDiv);
      // Waste
      let wasteDiv = document.createElement('div');
      wasteDiv.className = 'waste';
      if(board.waste.length) {
        let wc = board.waste[board.waste.length-1];
        wasteDiv.appendChild(createCardDiv(wc, wc.faceup));
      }
      row1.appendChild(wasteDiv);
      // Foundations
      for(let i=0;i<4;i++) {
        let fd = document.createElement('div');
        fd.className = 'foundation';
        fd.onclick = () => selectFoundation(i);
        if(board.foundations[i].length) {
          let fc = board.foundations[i][board.foundations[i].length-1];
          fd.appendChild(createCardDiv(fc, fc.faceup));
        } else {
          fd.innerHTML = `<span style="color:#bcb7de">A</span>`;
        }
        row1.appendChild(fd);
      }
      boardDiv.appendChild(row1);
      // Tableaus
      for(let i=0;i<7;i++) {
        let pileDiv = document.createElement('div');
        pileDiv.className = 'pile';
        pileDiv.onclick = () => selectPile(i);
        let offset = 0;
        board.piles[i].forEach((card, idx) => {
          let cd = createCardDiv(card, card.faceup);
          cd.style.top = `${idx * 18}px`;
          cd.onclick = (e) => {e.stopPropagation(); selectCard(i, idx);}
          pileDiv.appendChild(cd);
        });
        boardDiv.appendChild(pileDiv);
      }
    }
    function createCardDiv(card, faceup) {
      let div = document.createElement('div');
      div.className = 'card' + (faceup ? ' faceup':' facedown');
      div.innerText = faceup ? card.toString() : '';
      div.style.color = faceup ? (card.color() === "red" ? "#e57490":"#4a518c") : "#fff";
      return div;
    }
    function drawFromStock() {
      if(!board.stock.length) return;
      let card = board.stock.pop();
      card.faceup = true;
      board.waste.push(card);
      render();
    }
    function selectPile(i) { /* Logic to select and move stacks */ }
    function selectFoundation(i) { /* Logic for foundation moves */ }
    function selectCard(pileIdx, cardIdx) { /* Selection + Drag-n-Drop logic */ }
    // Instructions Popup
    function showInstructions() {
      document.getElementById('instructions-popup').style.display = 'block';
    }
    function hideInstructions() {
      document.getElementById('instructions-popup').style.display = 'none';
    }
    // Initialize
    window.onload = () => { deal(); }
  </script>
</body>
</html>
