<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tile Slider Puzzle</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    font-family: 'Nunito', Arial, sans-serif;
    background: linear-gradient(180deg, #e5c1d1 0%, #d3e6f5 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
    padding: 1rem;
  }
  .game-container {
    background: rgba(255 255 255 / 0.9);
    border-radius: 16px;
    box-shadow: 0 8px 30px #aac7f688, 0 4px 12px #4980e088;
    max-width: 380px;
    width: 100%;
    padding: 1.5rem 1.8rem 2rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
  }
  .game-header {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 1rem;
    position: relative;
  }
  .game-title {
    font-size: 2.2rem;
    font-weight: 800;
    color: #2862ea;
    text-shadow: 1px 2px 0 #fff, 0 0 8px #aac7f6;
    letter-spacing: 0.07em;
    user-select: none;
  }
  .info-icon {
    position: absolute;
    right: 0;
    width: 28px;
    height: 28px;
    cursor: pointer;
    fill: #2862ea;
    user-select: none;
    transition: fill 0.2s ease;
  }
  .info-icon:hover {
    fill: #3bb9fa;
  }
  .board {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    width: 320px;
    aspect-ratio: 1 / 1;
    gap: 0.6rem;
    background: #f0f8fb;
    border-radius: 14px;
    padding: 0.6rem;
    box-shadow: inset 0 4px 12px #aac7f622;
  }
  .tile {
    background: #dde7fc;
    border-radius: 10px;
    font-size: 2.4rem;
    font-weight: 700;
    color: #2862ea;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
    box-shadow: 0 2px 10px #aac7f666;
    cursor: pointer;
    transition: box-shadow 0.25s, transform 0.2s;
  }
  .tile:hover {
    box-shadow: 0 6px 20px #3bb9fa90;
    transform: scale(1.07);
  }
  .tile.empty {
    background: transparent;
    box-shadow: none;
    cursor: default;
  }
  .controls {
    margin-top: 1rem;
    width: 100%;
    display: flex;
    gap: 1rem;
    justify-content: center;
  }
  button {
    background: linear-gradient(90deg, #2862ea 60%, #3bb9fa 100%);
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    border: none;
    border-radius: 7px;
    padding: 0.6rem 1.8rem;
    box-shadow: 0 2px 8px #aac7f644;
    cursor: pointer;
    user-select: none;
    transition: box-shadow 0.18s, background 0.15s;
    flex: 1;
  }
  button:hover, button:focus {
    background: linear-gradient(90deg, #3bb9fa 60%, #2862ea 100%);
    box-shadow: 0 4px 18px #2862ea77;
    outline: none;
  }
  .status {
    margin-top: 0.75rem;
    font-weight: 700;
    font-size: 1.15rem;
    color: #2862ea;
    text-align: center;
    min-height: 1.5rem;
  }
  /* Popup Instructions */
  .popup-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.3);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  .popup-bg.active {
    display: flex;
  }
  .popup-content {
    background: white;
    border-radius: 14px;
    padding: 1.5rem 2rem;
    max-width: 320px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    font-size: 1rem;
    line-height: 1.4;
    color: #2862ea;
    position: relative;
    user-select: text;
  }
  .popup-close {
    position: absolute;
    top: 8px;
    right: 12px;
    border: none;
    background: none;
    font-size: 1.5rem;
    color: #2862ea;
    cursor: pointer;
    font-weight: 700;
    user-select: none;
  }
  .popup-close:hover {
    color: #3bb9fa;
  }
  @media (max-width: 400px) {
    .game-title {
      font-size: 1.8rem;
    }
    .board {
      width: 95vw;
      max-width: 360px;
      gap: 0.45rem;
    }
    .tile {
      font-size: 2rem;
    }
  }
</style>
</head>
<body>
  <div class="game-container" role="main" aria-label="Tile Slider Puzzle game">
    <div class="game-header">
      <div class="game-title">Tile Slider Puzzle</div>
      <svg class="info-icon" tabindex="0" role="button" aria-label="Show game instructions" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="#2862ea"></circle>
        <text x="12" y="17" font-size="14" text-anchor="middle" fill="white" font-weight="bold" font-family="Arial">i</text>
      </svg>
    </div>
    <div class="board" aria-live="polite" aria-label="Puzzle board" id="board"></div>
    <div class="status" id="status" role="status" aria-live="polite"></div>
    <div class="controls">
      <button id="shuffleBtn" aria-label="Shuffle puzzle">Shuffle</button>
      <button id="solveBtn" aria-label="Solve puzzle">Solve</button>
    </div>
  </div>

  <!-- Popup Instructions -->
  <div class="popup-bg" id="popupBg" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="popupTitle" tabindex="-1">
    <div class="popup-content">
      <h2 id="popupTitle">How to Play Tile Slider Puzzle</h2>
      <button class="popup-close" aria-label="Close instructions">&times;</button>
      <p>
        Slide tiles one at a time into the empty space to reorder the numbers.<br/>
        Arrange the tiles in order from 1 to 15 with the empty space at the end.<br/>
        Tap or click a tile adjacent to the empty space to move it.<br/>
        Use the "Shuffle" button for a new challenge.<br/>
        Use the "Solve" button to automatically solve the puzzle.<br/>
        Have fun!
      </p>
    </div>
  </div>

<script>
  (() => {
    const boardElem = document.getElementById('board');
    const statusElem = document.getElementById('status');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const solveBtn = document.getElementById('solveBtn');
    const infoIcon = document.querySelector('.info-icon');
    const popupBg = document.getElementById('popupBg');
    const popupClose = popupBg.querySelector('.popup-close');

    const dimension = 4;
    let board = [];
    let emptyPos = { row: dimension - 1, col: dimension - 1 };

    function initBoard() {
      board = [];
      for(let i=1; i < dimension * dimension; i++) {
        board.push(i);
      }
      board.push(null); // empty space
      emptyPos = { row: dimension -1, col: dimension -1};
    }

    function isSolvable(arr) {
      // Count inversions for solvability
      let invCount = 0;
      const flatten = arr.filter(n => n !== null);
      for(let i=0; i < flatten.length-1; i++) {
        for(let j=i+1; j < flatten.length; j++) {
          if(flatten[i] > flatten[j]) invCount++;
        }
      }
      return invCount % 2 === 0;
    }

    function shuffleBoard() {
      let arr = [...board];
      do {
        for(let i = arr.length -1; i > 0; i--) {
          let j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
      } while(!isSolvable(arr) || isSolved(arr));

      board = arr;
      emptyPos = {row: Math.floor(arr.indexOf(null) / dimension), col: arr.indexOf(null) % dimension};
    }

    function isSolved(arr = board) {
      for(let i=0; i < dimension * dimension -1; i++) {
        if(arr[i] !== i + 1) return false;
      }
      return true;
    }

    function renderBoard() {
      boardElem.innerHTML = '';
      for(let i=0; i < board.length; i++) {
        const row = Math.floor(i / dimension);
        const col = i % dimension;
        const value = board[i];
        const tile = document.createElement('div');

        tile.className = 'tile ' + (value === null ? 'empty' : '');
        tile.setAttribute('data-row', row);
        tile.setAttribute('data-col', col);
        tile.setAttribute('tabindex', value !== null ? '0' : '-1');
        tile.setAttribute('role', 'button');
        tile.setAttribute('aria-label', value === null ? 'Empty space' : `Tile ${value}`);

        tile.textContent = value === null ? '' : value;

        if(value !== null) {
          tile.addEventListener('click', () => onTileClick(row, col));
          tile.addEventListener('keydown', (e) => {
            if(e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              onTileClick(row, col);
            }
          });
        }

        boardElem.appendChild(tile);
      }
      if(isSolved()) {
        statusElem.textContent = 'ðŸŽ‰ Congratulations! You solved the puzzle.';
      } else {
        statusElem.textContent = 'Rearrange tiles to order 1-15.';
      }
    }

    function onTileClick(row, col) {
      if(canMove(row, col)) {
        moveTile(row, col);
        renderBoard();
      }
    }

    function canMove(row, col) {
      const distance = Math.abs(emptyPos.row - row) + Math.abs(emptyPos.col - col);
      return distance === 1;
    }

    function moveTile(row, col) {
      const emptyIndex = emptyPos.row * dimension + emptyPos.col;
      const clickedIndex = row * dimension + col;

      [board[emptyIndex], board[clickedIndex]] = [board[clickedIndex], board[emptyIndex]];
      emptyPos = { row, col };
    }

    shuffleBtn.addEventListener('click', () => {
      shuffleBoard();
      renderBoard();
    });

    solveBtn.addEventListener('click', () => {
      board = [];
      for(let i=1; i < dimension * dimension; i++) {
        board.push(i);
      }
      board.push(null);
      emptyPos = { row: dimension - 1, col: dimension - 1 };
      renderBoard();
      statusElem.textContent = 'Puzzle solved!';
    });

    infoIcon.addEventListener('click', () => {
      popupBg.classList.add('active');
      popupBg.setAttribute('aria-hidden', 'false');
      popupBg.focus();
    });
    popupClose.addEventListener('click', () => {
      popupBg.classList.remove('active');
      popupBg.setAttribute('aria-hidden', 'true');
    });
    popupBg.addEventListener('click', (e) => {
      if(e.target === popupBg){
        popupBg.classList.remove('active');
        popupBg.setAttribute('aria-hidden', 'true');
      }
    });

    // Initialize game on load
    initBoard();
    shuffleBoard();
    renderBoard();

  })();
</script>
</body>
</html>